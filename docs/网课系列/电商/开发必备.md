---
title: 开发必备
date: 2021-02-08
categories:
- 实战项目
---
## 前置要求:
了解微信小程序开发流程（入门级）。参考 [《微信小程序开发指南》](https://developers.weixin.qq.com/ebook?action=get_post_info&docid=0008aeea9a8978ab0086a685851c0a)
## 网络请求的封装
在微信小程序官网文档中，有网络请求的完整api，但是使用起来特别的啰嗦，每个请求都必须写一大段的模板代码，特别不易维护。所以需要对原生的网络请求进行封装，抽取模板代码,只关注变得部分。
其中使用到了es6,es7中的模块化和异步操作，来简化我们的代码，其中es系列请参考[MDN JS教程](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript)
## 对wx.request进行异步封装
由于微信网络请求并不支持Promise，所以需要对其进行封装，以便后期可以使用异步的高级特性
```js
/**
 * 对不支持promise的函数进行封装，并返回promise对象
 * @param func
 * @returns {function(*=): Promise<unknown>}
 */
const promise = function (func) {
    return function (params = {}) {
        return new Promise((resolve, reject) => {
            const args = Object.assign(params, {
                success: (res) => {
                    resolve(res);
                },
                fail: (error) => {
                    reject(error);
                }
            });
            func(args);
        });
    };
};

export
{
    promise
}
```
## 对微信网络请求进行封装
```js
import {config} from "../config/config";
import {promise} from "./utils"
class Http{
    static async request({url,method="GET",data}){
     const res= await promise(wx.request)({
          url:config.apiBaseUrl+url,
          method,
          data,
          header: {
              appkey: config.appkey
          },
      })
        console.log(`=====================请求接口：${url}  ==========================`)
        console.log(res)
        return res.data;

    };
}
export {
    Http
}
```
## 其中的config是配置文件，主要是服务器访问接口的根地址等
```js
const config={
    appkey:"28lh4pmP0GUcRAUH",
    apiBaseUrl:"http://se.talelin.com/v1/"
}
export {
    config
}
```
## 分层思想
model层，也就是业务处理层，是在前端开发中对于网络请求和数据处理操作的一种分层思想，借鉴于服务端中的MVC架构模式，主要目的用于解构，让页面js只承担起获取数据，数据绑定，以及页面事件工作。使得整个项目流程条例化，更易维护。
每个业务对象都有独立的js去管理。




